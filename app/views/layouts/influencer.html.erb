<!DOCTYPE html>
<html lang="<%= I18n.locale %>">
  <head>
    <title><%= content_for(:title) || "BaiFinanzas - Influencer" %></title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
    <%= stylesheet_link_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>
  </head>

  <body class="influencer-layout">
    <div class="d-flex" style="min-height: 100vh;">
      <%# Sidebar %>
      <nav class="admin-sidebar text-white d-flex flex-column" style="width: 250px; min-height: 100vh; position: fixed; top: 0; left: 0; z-index: 1000; background: #165668;">
        <div class="p-3 border-bottom" style="border-color: rgba(255,255,255,0.2) !important;">
          <h5 class="mb-0">
            <i class="bi bi-star-fill text-warning"></i>
            BaiFinanzas
          </h5>
          <small style="opacity: 0.7;">Panel de Influencer</small>
        </div>

        <ul class="nav flex-column p-2 flex-grow-1">
          <li class="nav-item">
            <%= link_to influencer_dashboard_path, class: "nav-link text-white #{'active rounded' if action_name == 'dashboard'}", style: "#{'background: rgba(255,255,255,0.15);' if action_name == 'dashboard'}" do %>
              <i class="bi bi-speedometer2 me-2"></i> Dashboard
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to influencer_links_path, class: "nav-link text-white #{'active rounded' if action_name == 'links'}", style: "#{'background: rgba(255,255,255,0.15);' if action_name == 'links'}" do %>
              <i class="bi bi-link-45deg me-2"></i> Enlaces Afiliados
            <% end %>
          </li>
          <li class="nav-item">
            <%= link_to influencer_videos_path, class: "nav-link text-white #{'active rounded' if action_name == 'videos'}", style: "#{'background: rgba(255,255,255,0.15);' if action_name == 'videos'}" do %>
              <i class="bi bi-camera-video me-2"></i> Videos
            <% end %>
          </li>
        </ul>

        <div class="p-3" style="border-top: 1px solid rgba(255,255,255,0.2);">
          <div class="d-flex align-items-center gap-2 mb-2">
            <i class="bi bi-person-circle"></i>
            <small><%= current_user&.email&.truncate(20) %></small>
          </div>
          <%= button_to destroy_user_session_path, method: :delete, class: "btn btn-outline-light btn-sm w-100" do %>
            <i class="bi bi-box-arrow-right me-1"></i> Cerrar sesion
          <% end %>
        </div>
      </nav>

      <%# Main content %>
      <div class="flex-grow-1" style="margin-left: 250px;">
        <%# Top bar %>
        <header class="bg-white border-bottom px-4 py-3 d-flex justify-content-between align-items-center">
          <h4 class="mb-0"><%= content_for(:page_title) || "Dashboard" %></h4>
          <div class="text-muted">
            <small><%= current_user&.email %></small>
          </div>
        </header>

        <%# Flash messages %>
        <div class="px-4 pt-3">
          <% if notice.present? %>
            <div class="alert alert-success alert-dismissible fade show" role="alert">
              <i class="bi bi-check-circle-fill me-1"></i> <%= notice %>
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          <% end %>
          <% if alert.present? %>
            <div class="alert alert-danger alert-dismissible fade show" role="alert">
              <i class="bi bi-exclamation-triangle-fill me-1"></i> <%= alert %>
              <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            </div>
          <% end %>
        </div>

        <%# Page content %>
        <div class="p-4">
          <%= yield %>
        </div>
      </div>
    </div>
  </body>
</html>
